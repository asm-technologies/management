from django.shortcuts import render
from django.shortcuts import render_to_response
from django.template import RequestContext
from django.views.generic import TemplateView
from django.contrib.auth.decorators import login_required
from django.http import HttpResponse


from employee.models import *


def employee(request):
	available_pjs = Employee.objects.filter().values('id')
	dict1 = []
	for x in available_pjs:
		ID = x['id']
		emp_name = Employee.objects.filter(id=ID).values('name')[0]['name']
		mobile = Employee.objects.filter(id=ID).values('mobile')[0]['mobile']
		email = Employee.objects.filter(id=ID).values('email')[0]['email']
		dict1.append({"emp_name":emp_name,"mobile":mobile,"email":email,"ID":ID})
		
		
		
	

	return render_to_response("employee.html",{"employee":"active",'mylist':dict1},context_instance=RequestContext(request))
	

def projects(request):
	return render_to_response("projects.html",{"projects":"active"},context_instance=RequestContext(request))

def home(request):
	available_pjs = Project.objects.filter().values('id')
	dict1 = []
	for x in available_pjs:
		ID = x['id']
		proj_name = Project.objects.filter(id=ID).values('name')[0]['name']
		project = Employee.objects.filter(proj=ID).count()
		not_bill = Employee.objects.filter(proj=ID,bill=0).count()
		dict1.append({"proj_name":proj_name,"project":project,"not_bill":not_bill,"ID":ID})
		
		dict2 = dict1[:]
	

	return render_to_response("homepage.html",{"home":"active",'mylist':dict1,"mylist2":dict2},context_instance=RequestContext(request))
	
	
